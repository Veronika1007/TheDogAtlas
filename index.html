<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>TheDogAtlas ‚Äì Dog‚ÄëFriendly Map & Planner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div class="brand">
        <img
          src="Logo.png"
          alt="TheDogAtlas Logo"
          style="height: 36px; width: auto"
        />
        <div>
          <div style="font-weight: 700; font-size: 16px">TheDogAtlas</div>
          <div style="font-size: 11px; color: var(--muted)">
            The dog-first travel platform
          </div>
        </div>
      </div>
      <nav>
        <a
          href="#"
          onclick="showPage('map-page')"
          class="nav-link active"
          id="nav-map"
          >Map</a
        >
        <a
          href="#"
          onclick="showPage('planner-page')"
          class="nav-link"
          id="nav-planner"
          >Planner</a
        >
        <a href="#trails">Trails</a>
        <a href="#community">Community</a>
      </nav>
    </header>

    <main>
      <div id="map-page" class="page active">
        <section class="hero">
          <div>
            <div class="hero-tag">
              <span>üó∫Ô∏è</span>
              <span>Hertfordshire Beta ¬∑ Verified Venues Only</span>
            </div>
            <h1>Find dog‚Äëfriendly pubs, stays & walking trails in seconds.</h1>

            <form
              class="hero-form"
              onsubmit="event.preventDefault(); demoSearch();"
            >
              <input
                id="whereInput"
                type="text"
                placeholder="Location (e.g. St Albans)"
                value="Hertfordshire"
                style="margin-bottom: 10px; width: 100%"
              />

              <div class="multi-filter-container" id="categoryFilters">
                <label class="filter-option"
                  ><input type="checkbox" value="pub" /> Pubs & Bars</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="cafe" /> Cafe</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="restaurant" />
                  Restaurants</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="shop" /> Shops & Retail</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="attraction" />
                  Attractions</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="park" /> Parks</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="beach" /> Beaches</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="hotel" /> Hotel & B&Bs</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="vet" /> Vets</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="groomer" /> Groomers</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="trainer" /> Trainers</label
                >
                <label class="filter-option"
                  ><input type="checkbox" value="service" /> Daycare &
                  Kennels</label
                >
              </div>

              <button type="submit" style="width: 100%">
                Search & Filter Map
              </button>
            </form>
          </div>
          <aside class="hero-card" style="text-align: center">
            <h3>Smart Planner</h3>
            <p>Build a curated day-by-day trip schedule.</p>
            <button onclick="showPage('planner-page')" class="primary-btn">
              Open Planner
            </button>
          </aside>
        </section>

        <section class="layout">
          <div class="panel">
            <h2>Interactive Map</h2>
            <div
              id="mapBox"
              style="
                height: 400px;
                border-radius: 12px;
                margin-bottom: 15px;
                border: 1px solid var(--border);
                z-index: 1;
              "
            ></div>

            <h2>Search Results</h2>
            <div class="results" id="resultsBox"></div>
          </div>

          <aside class="panel" id="trails">
            <h2>Featured Walking Trail</h2>
            <div class="trail-card">
              <h3>Verulamium Park Loop</h3>
              <small>4.2 km ¬∑ Easy ¬∑ Off-lead fields</small>

              <div
                id="trailMap"
                style="
                  height: 180px;
                  border-radius: 8px;
                  margin: 12px 0;
                  border: 1px solid var(--border);
                  z-index: 1;
                "
              ></div>

              <div
                class="trail-meta"
                style="font-size: 12px; color: var(--muted); margin-bottom: 8px"
              >
                A gentle riverside circuit with wide paths, green space for
                off-lead play, and a dog-friendly caf√© at the park edge.
              </div>
              <div class="pill-row">
                <span class="pill">Water access</span>
                <span class="pill">Caf√© stop</span>
                <span class="pill">Parking nearby</span>
              </div>
            </div>
          </aside>
        </section>
      </div>

      <div id="planner-page" class="page">
        <section class="hero">
          <div>
            <h1>Intelligent Itinerary Planner</h1>
            <p>
              Suggested schedules for breakfast, lunch, and dog-friendly
              activities.
            </p>
            <form
              class="hero-form"
              onsubmit="event.preventDefault(); generateItinerary();"
            >
              <input
                type="text"
                id="planDest"
                value="St Albans"
                style="width: 100%; margin-bottom: 10px"
              />
              <button type="submit" style="width: 100%">Generate Trip</button>
            </form>
          </div>
        </section>
        <div id="itineraryResult" class="panel hidden">
          <h2 id="itineraryTitle">Your Trip</h2>
          <div id="itineraryTimeline"></div>
        </div>
      </div>
    </main>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      /* --- NAVIGATION LOGIC --- */
      function showPage(pageId) {
        document
          .querySelectorAll(".page")
          .forEach((p) => p.classList.remove("active"));
        document.getElementById(pageId).classList.add("active");
        document
          .querySelectorAll(".nav-link")
          .forEach((n) => n.classList.remove("active"));

        if (pageId === "map-page") {
          document.getElementById("nav-map").classList.add("active");
          setTimeout(() => {
            map.invalidateSize();
          }, 200);
        } else if (pageId === "planner-page") {
          document.getElementById("nav-planner").classList.add("active");
        }
      }

      /* --- MAIN MAP INITIALIZATION --- */
      const map = L.map("mapBox").setView([51.7527, -0.3394], 13);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "&copy; OpenStreetMap",
      }).addTo(map);

      let markersLayer = L.layerGroup().addTo(map);

      /* --- FEATURED TRAIL MAP INITIALIZATION --- */
      window.addEventListener("load", function () {
        const trailCoords = [51.751, -0.345];
        const trailMap = L.map("trailMap", {
          zoomControl: false,
          attributionControl: false,
        }).setView(trailCoords, 14);

        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(
          trailMap
        );
        L.marker(trailCoords).addTo(trailMap);
        L.circle(trailCoords, { color: "green", radius: 500 }).addTo(trailMap);
      });

      /* --- VENUE DATA --- */
      const demoVenues = [
        {
          name: "The Wagging Tail Pub",
          type: "pub",
          lat: 51.75,
          lng: -0.34,
          note: "Verified garden seating.",
        },
        {
          name: "Paws & Beans Caf√©",
          type: "cafe",
          lat: 51.753,
          lng: -0.335,
          note: "Indoor dogs welcome.",
        },
        {
          name: "Verulamium Riverside",
          type: "trail",
          lat: 51.751,
          lng: -0.345,
          note: "4.2km loop walk.",
        },
      ];

      /* --- SEARCH & MULTI-FILTER --- */
      function demoSearch() {
        const selectedCats = Array.from(
          document.querySelectorAll("#categoryFilters input:checked")
        ).map((cb) => cb.value);
        let filtered = demoVenues.filter(
          (v) => selectedCats.length === 0 || selectedCats.includes(v.type)
        );

        markersLayer.clearLayers();
        filtered.forEach((v) => {
          L.marker([v.lat, v.lng])
            .addTo(markersLayer)
            .bindPopup(`<b>${v.name}</b><br>${v.note}`);
        });

        document.getElementById("resultsBox").innerHTML =
          filtered
            .map(
              (v) => `
          <div class="result-card">
            <div>
              <h3>${v.name}</h3>
              <small>${v.type.toUpperCase()}</small>
              <p style="font-size: 12px; margin: 4px 0;">${v.note}</p>
            </div>
          </div>
        `
            )
            .join("") || "<p>No results found.</p>";
      }

      /* --- PLANNER LOGIC --- */
      function generateItinerary() {
        document.getElementById("itineraryResult").classList.remove("hidden");
        document.getElementById("itineraryTimeline").innerHTML = `
          <div class="result-card"><strong>09:00 Breakfast</strong><br>Paws & Beans Caf√©</div>
          <div class="result-card"><strong>13:30 Lunch</strong><br>The Wagging Tail Pub</div>
        `;
      }

      demoSearch();
    </script>
  </body>
</html>
